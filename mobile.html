<!DOCTYPE HTML>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <title>GameBoy Advance</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="mobile.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script>
  $(document).ready(function () {
    // List ROMs
    $.ajax({
      method: 'POST',
      url: 'server.php',
      data: {
        request: 'listRoms'
      }
    })
    .done(function(msg) {
      var roms = JSON.parse(msg);

      var selections = $('#selections').html('');
      roms.forEach(function (rom) { 
        selections.append('<li>' + rom.substr(0, rom.length - 4) + '</li>');
      });

      // Rom selected
      $('#selections li').click(function () {
        var romName = $(this).text();

        $('body').append('<div id="cover"></div>');
        $('#cover')
          .fadeIn('fast', function () {
            // Bring up canvas
            window.location = 'gba.html?rom=' + romName;
          });
      });

      // $('#selections li').last().click();
    });

    // Rom search filter
    $('#search').on('change keyup paste', function () {
      var searchterm = $(this).val().toLowerCase();
      $('ul').children().each(function () {
        var hide = $(this).text().toLowerCase().indexOf(searchterm) < 0;
        $(this).toggleClass('hidden', hide);
      });
    });
  });
  </script>
</head>
<body>
  <div id="container">
    <header>
      <h1>GameBoy Advance</h1>
    </header>
    <div id="select-game">
      <input type="text" id="search" placeholder="Search" />
      <ul id="selections">
        <li>Loading ROMs...</li>
      </ul>
    </div>
    <footer>
    <p>Ajay Gandhi <a href="http://ajay-gandhi.com">ajay-gandhi.com</a></p>
    </footer>
  </div>
</body>
</html>
